# åŸæ¸¸æˆA Dark Roomç«æŠŠéœ€æ±‚åˆ†æ

**æœ€åæ›´æ–°**: 2025-06-26

## æ¦‚è¿°

åŸºäºåŸæ¸¸æˆæºä»£ç `../adarkroom/script/events/setpieces.js`çš„è¯¦ç»†åˆ†æï¼Œç¡®å®šå“ªäº›åœ°å½¢çœŸæ­£éœ€è¦ç«æŠŠã€‚

## ğŸ” åŸæ¸¸æˆæºä»£ç åˆ†æç»“æœ

### âœ… éœ€è¦ç«æŠŠçš„åœ°å½¢

#### 1. æ´ç©´ (Cave) - åœ°å½¢æ ‡è®° V
```javascript
"cave": {
    title: _('A Damp Cave'),
    scenes: {
        'start': {
            buttons: {
                'enter': {
                    text: _('go inside'),
                    cost: { torch: 1 },  // âœ… éœ€è¦1ä¸ªç«æŠŠ
                    nextScene: {0.3: 'a1', 0.6: 'a2', 1: 'a3'}
                }
            }
        }
    }
}
```

#### 2. åºŸå¼ƒå°é•‡ (Town) - åœ°å½¢æ ‡è®° O
```javascript
"town": {
    title: _('A Deserted Town'),
    scenes: {
        'start': {
            buttons: {
                'enter': {
                    text: _('explore'),
                    nextScene: {0.3: 'a1', 0.7: 'a3', 1: 'a2'}
                    // âŒ åˆå§‹è¿›å…¥ä¸éœ€è¦ç«æŠŠ
                }
            }
        },
        'a1': {
            buttons: {
                'enter': {
                    text: _('enter'),
                    nextScene: {0.5: 'b1', 1: 'b2'},
                    cost: {torch: 1}  // âœ… è¿›å…¥å»ºç­‘éœ€è¦1ä¸ªç«æŠŠ
                }
            }
        },
        'a3': {
            buttons: {
                'enter': {
                    text: _('enter'),
                    nextScene: {0.5: 'b5', 1: 'end5'},
                    cost: {torch: 1}  // âœ… è¿›å…¥å»ºç­‘éœ€è¦1ä¸ªç«æŠŠ
                }
            }
        }
    }
}
```

#### 3. åºŸå¢ŸåŸå¸‚ (City) - åœ°å½¢æ ‡è®° Y
```javascript
"city": {
    title: _('A Ruined City'),
    scenes: {
        'a1': {
            buttons: {
                'enter': {
                    text: _('enter'),
                    cost: { 'torch': 1 },  // âœ… è¿›å…¥åŒ»é™¢éœ€è¦1ä¸ªç«æŠŠ
                    nextScene: {0.5: 'b7', 1: 'b8'}
                }
            }
        },
        'c9': {
            buttons: {
                'enter': {
                    text: _('investigate'),
                    cost: { 'torch': 1 },  // âœ… è°ƒæŸ¥éš§é“éœ€è¦1ä¸ªç«æŠŠ
                    nextScene: {0.5: 'd2', 1: 'd3'}
                }
            }
        }
    }
}
```

#### 4. é“çŸ¿ (Iron Mine) - åœ°å½¢æ ‡è®° I
```javascript
"ironmine": {
    title: _('The Iron Mine'),
    scenes: {
        'start': {
            buttons: {
                'enter': {
                    text: _('go inside'),
                    nextScene: { 1: 'enter' },
                    cost: { 'torch': 1 }  // âœ… éœ€è¦1ä¸ªç«æŠŠ
                }
            }
        }
    }
}
```

### âŒ ä¸éœ€è¦ç«æŠŠçš„åœ°å½¢

#### 1. ç…¤çŸ¿ (Coal Mine) - åœ°å½¢æ ‡è®° C
```javascript
"coalmine": {
    title: _('The Coal Mine'),
    scenes: {
        'start': {
            buttons: {
                'attack': {
                    text: _('attack'),
                    nextScene: {1: 'a1'}
                    // âŒ ç›´æ¥æ”»å‡»ï¼Œä¸éœ€è¦ç«æŠŠ
                }
            }
        }
    }
}
```

#### 2. ç¡«ç£ºçŸ¿ (Sulphur Mine) - åœ°å½¢æ ‡è®° S
```javascript
"sulphurmine": {
    title: _('The Sulphur Mine'),
    scenes: {
        'start': {
            buttons: {
                'attack': {
                    text: _('attack'),
                    nextScene: {1: 'a1'}
                    // âŒ ç›´æ¥æ”»å‡»ï¼Œä¸éœ€è¦ç«æŠŠ
                }
            }
        }
    }
}
```

## ğŸ“Š ç«æŠŠéœ€æ±‚æ€»ç»“

### âœ… éœ€è¦ç«æŠŠçš„åœ°å½¢ (4ä¸ª)

| åœ°å½¢ | æ ‡è®° | ç«æŠŠéœ€æ±‚ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|----------|
| æ½®æ¹¿æ´ç©´ | V | 1ä¸ª | è¿›å…¥æ´ç©´æ¢ç´¢ |
| åºŸå¼ƒå°é•‡ | O | 1ä¸ª | è¿›å…¥å»ºç­‘ç‰©å†…éƒ¨ |
| åºŸå¢ŸåŸå¸‚ | Y | 1ä¸ª | è¿›å…¥åŒ»é™¢/è°ƒæŸ¥éš§é“ |
| é“çŸ¿ | I | 1ä¸ª | è¿›å…¥çŸ¿äº• |

### âŒ ä¸éœ€è¦ç«æŠŠçš„åœ°å½¢ (2ä¸ª)

| åœ°å½¢ | æ ‡è®° | ç«æŠŠéœ€æ±‚ | åŸå›  |
|------|------|----------|------|
| ç…¤çŸ¿ | C | æ—  | ç›´æ¥æ”»å‡»åœºæ™¯ |
| ç¡«ç£ºçŸ¿ | S | æ—  | ç›´æ¥æ”»å‡»åœºæ™¯ |

## ğŸ”§ å…³é”®å‘ç°

### 1. åºŸå¼ƒå°é•‡çš„å¤æ‚é€»è¾‘

åºŸå¼ƒå°é•‡(Town)æœ‰ä¸¤å±‚é€»è¾‘ï¼š
- **åˆå§‹æ¢ç´¢**: ä¸éœ€è¦ç«æŠŠï¼Œå¯ä»¥ç›´æ¥è¿›å…¥å°é•‡
- **è¿›å…¥å»ºç­‘**: éœ€è¦ç«æŠŠç…§æ˜ï¼Œè¿›å…¥å…·ä½“å»ºç­‘ç‰©æ—¶éœ€è¦1ä¸ªç«æŠŠ

### 2. çŸ¿å±±çš„åŒºåˆ«

- **é“çŸ¿**: éœ€è¦ç«æŠŠè¿›å…¥ï¼Œå› ä¸ºæ˜¯æ¢ç´¢åœºæ™¯
- **ç…¤çŸ¿/ç¡«ç£ºçŸ¿**: ä¸éœ€è¦ç«æŠŠï¼Œå› ä¸ºæ˜¯ç›´æ¥æ”»å‡»å†›äº‹æ®ç‚¹

### 3. åŸå¸‚çš„ç‰¹æ®Šæƒ…å†µ

åºŸå¢ŸåŸå¸‚(City)åœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸­éœ€è¦ç«æŠŠï¼š
- è¿›å…¥åºŸå¼ƒåŒ»é™¢
- è°ƒæŸ¥åœ°ä¸‹éš§é“

## ğŸ¯ ä¸å½“å‰å®ç°çš„å¯¹æ¯”

### å½“å‰å®ç°çš„é”™è¯¯

1. **è¿‡åº¦ç®€åŒ–**: å°†æ‰€æœ‰"å±é™©"åœ°å½¢éƒ½åŠ å…¥ç«æŠŠæ£€æŸ¥
2. **å¿½ç•¥å¤æ‚é€»è¾‘**: æ²¡æœ‰è€ƒè™‘åºŸå¼ƒå°é•‡çš„ä¸¤å±‚é€»è¾‘
3. **é”™è¯¯åˆ†ç±»**: å°†ç…¤çŸ¿å’Œç¡«ç£ºçŸ¿å½’ç±»ä¸ºéœ€è¦ç«æŠŠçš„åœ°å½¢

### éœ€è¦ä¿®å¤çš„é—®é¢˜

1. **åºŸå¼ƒå°é•‡**: åˆå§‹è¿›å…¥ä¸éœ€è¦ç«æŠŠï¼Œåªæœ‰è¿›å…¥å»ºç­‘æ—¶æ‰éœ€è¦
2. **ç…¤çŸ¿/ç¡«ç£ºçŸ¿**: å®Œå…¨ä¸éœ€è¦ç«æŠŠæ£€æŸ¥
3. **åŸå¸‚**: éœ€è¦åœ¨ç‰¹å®šåœºæ™¯ä¸­æ£€æŸ¥ç«æŠŠ

## ğŸ”„ ä¿®å¤å»ºè®®

### 1. æ›´æ–°ç«æŠŠæ£€æŸ¥é€»è¾‘

```dart
bool _needsTorchCheck(String setpieceName, String? sceneName) {
  switch (setpieceName) {
    case 'cave':
      return sceneName == 'start'; // æ´ç©´è¿›å…¥æ—¶éœ€è¦
    case 'town':
      return sceneName == 'a1' || sceneName == 'a3'; // è¿›å…¥å»ºç­‘æ—¶éœ€è¦
    case 'city':
      return sceneName == 'a1' || sceneName == 'c9'; // ç‰¹å®šåœºæ™¯éœ€è¦
    case 'ironmine':
      return sceneName == 'start'; // é“çŸ¿è¿›å…¥æ—¶éœ€è¦
    default:
      return false; // å…¶ä»–åœ°å½¢ä¸éœ€è¦
  }
}
```

### 2. ç§»é™¤é”™è¯¯çš„ç«æŠŠæ£€æŸ¥

- ç…¤çŸ¿(coalmine): å®Œå…¨ç§»é™¤ç«æŠŠæ£€æŸ¥
- ç¡«ç£ºçŸ¿(sulphurmine): å®Œå…¨ç§»é™¤ç«æŠŠæ£€æŸ¥

## ğŸ“ ç»“è®º

åŸæ¸¸æˆçš„ç«æŠŠéœ€æ±‚æ¯”ä¹‹å‰åˆ†æçš„æ›´å¤æ‚ï¼š

1. **æ´ç©´**: å§‹ç»ˆéœ€è¦ç«æŠŠ âœ…
2. **åºŸå¼ƒå°é•‡**: åªåœ¨è¿›å…¥å»ºç­‘æ—¶éœ€è¦ç«æŠŠ âš ï¸
3. **åºŸå¢ŸåŸå¸‚**: åªåœ¨ç‰¹å®šåœºæ™¯éœ€è¦ç«æŠŠ âš ï¸
4. **é“çŸ¿**: è¿›å…¥æ—¶éœ€è¦ç«æŠŠ âœ…
5. **ç…¤çŸ¿**: ä¸éœ€è¦ç«æŠŠ âŒ
6. **ç¡«ç£ºçŸ¿**: ä¸éœ€è¦ç«æŠŠ âŒ

è¿™ä¸ªåˆ†æçº æ­£äº†ä¹‹å‰æ–‡æ¡£ä¸­çš„é”™è¯¯ï¼Œç¡®ä¿äº†ä¸åŸæ¸¸æˆçš„å®Œå…¨ä¸€è‡´æ€§ã€‚
