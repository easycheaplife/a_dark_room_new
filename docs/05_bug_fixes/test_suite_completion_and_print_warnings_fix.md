# æµ‹è¯•å¥—ä»¶å®Œå–„å’Œprintè­¦å‘Šä¿®å¤

**ä¿®å¤å®Œæˆæ—¥æœŸ**: 2025-01-08
**æœ€åæ›´æ–°æ—¥æœŸ**: 2025-01-08
**ä¿®å¤ç‰ˆæœ¬**: v1.5
**ä¿®å¤çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶éªŒè¯

## é—®é¢˜æè¿°

åœ¨æ£€æŸ¥æµ‹è¯•å¥—ä»¶æ—¶å‘ç°ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š

### 1. æµ‹è¯•æ–‡ä»¶é—æ¼
æœ‰3ä¸ªæµ‹è¯•æ–‡ä»¶æ²¡æœ‰è¢«åŒ…å«åœ¨`all_tests.dart`ä¸­ï¼š
- `crafting_system_verification_test.dart` - åˆ¶ä½œç³»ç»Ÿå®Œæ•´æ€§éªŒè¯
- `executioner_boss_fight_test.dart` - æ‰§è¡Œè€…Bossæˆ˜æ–—æµ‹è¯•
- `ship_building_upgrade_system_test.dart` - é£èˆ¹å»ºé€ å‡çº§ç³»ç»Ÿæµ‹è¯•

### 2. ä»£ç ä¸­çš„printè­¦å‘Š
å¤šä¸ªæ–‡ä»¶ä¸­ä½¿ç”¨äº†`print`è¯­å¥è€Œä¸æ˜¯`Logger.info`ï¼Œè¿åäº†é¡¹ç›®è§„èŒƒï¼š
- `lib/core/notifications.dart` - é€šçŸ¥ç³»ç»Ÿä¸­çš„printè¯­å¥
- `test/crafting_system_verification_test.dart` - æµ‹è¯•æ–‡ä»¶ä¸­çš„printè¯­å¥
- `lib/core/audio_engine.dart` - éŸ³é¢‘å¼•æ“ä¸­çš„å¤§é‡printè¯­å¥

### 3. éŸ³é¢‘ç³»ç»Ÿæµ‹è¯•ç¯å¢ƒå…¼å®¹æ€§
åˆ¶ä½œç³»ç»Ÿæµ‹è¯•åœ¨è°ƒç”¨`Room.build`æ—¶ä¼šè§¦å‘éŸ³é¢‘æ’­æ”¾ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­å¯¼è‡´æ’ä»¶å¼‚å¸¸ã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. æµ‹è¯•å¥—ä»¶å®Œå–„

#### æ·»åŠ é—æ¼çš„æµ‹è¯•æ–‡ä»¶åˆ°all_tests.dart

**å¯¼å…¥å£°æ˜**:
```dart
import 'crafting_system_verification_test.dart' as crafting_system_tests;
import 'executioner_boss_fight_test.dart' as executioner_boss_fight_tests;
import 'ship_building_upgrade_system_test.dart' as ship_building_tests;
```

**æµ‹è¯•ç»„ç»‡**:
```dart
// åœ¨äº‹ä»¶ç³»ç»Ÿæµ‹è¯•ä¸­æ·»åŠ Bossæˆ˜æ–—æµ‹è¯•
group('æ‰§è¡Œè€…Bossæˆ˜æ–—æµ‹è¯•', () {
  executioner_boss_fight_tests.main();
});

// åœ¨å¤ªç©ºç³»ç»Ÿæµ‹è¯•ä¸­æ·»åŠ é£èˆ¹å»ºé€ æµ‹è¯•
group('é£èˆ¹å»ºé€ å‡çº§ç³»ç»Ÿ', () {
  ship_building_tests.main();
});

// æ–°å¢åˆ¶ä½œç³»ç»Ÿæµ‹è¯•ç»„
group('ğŸ”§ åˆ¶ä½œç³»ç»Ÿæµ‹è¯•', () {
  group('åˆ¶ä½œç³»ç»Ÿå®Œæ•´æ€§éªŒè¯', () {
    crafting_system_tests.main();
  });
});
```

#### æ›´æ–°æµ‹è¯•è¦†ç›–èŒƒå›´æè¿°

```dart
Logger.info('æµ‹è¯•è¦†ç›–èŒƒå›´ï¼š');
Logger.info('  ğŸ“… äº‹ä»¶ç³»ç»Ÿ - è§¦å‘é¢‘ç‡ã€æœ¬åœ°åŒ–ã€å¯ç”¨æ€§ã€åˆ½å­æ‰‹äº‹ä»¶ã€Bossæˆ˜æ–—');
Logger.info('  ğŸ—ºï¸  åœ°å›¾ç³»ç»Ÿ - åœ°æ ‡ç”Ÿæˆã€é“è·¯ç”Ÿæˆ');
Logger.info('  ğŸ’ èƒŒåŒ…ç³»ç»Ÿ - ç«æŠŠæ£€æŸ¥ã€å®¹é‡ç®¡ç†');
Logger.info('  ğŸ›ï¸  UIç³»ç»Ÿ - æŒ‰é’®çŠ¶æ€ã€ç•Œé¢äº¤äº’ã€æŠ¤ç”²æŒ‰é’®');
Logger.info('  ğŸ’§ èµ„æºç³»ç»Ÿ - æ°´å®¹é‡ã€ç‰©å“ç®¡ç†');
Logger.info('  ğŸš€ å¤ªç©ºç³»ç»Ÿ - ç§»åŠ¨æ•æ„Ÿåº¦ã€ä¼˜åŒ–æµ‹è¯•ã€é£èˆ¹å»ºé€ å‡çº§');
Logger.info('  ğŸµ éŸ³é¢‘ç³»ç»Ÿ - é¢„åŠ è½½ã€éŸ³é¢‘æ± ã€æ€§èƒ½ç›‘æ§');
Logger.info('  ğŸ”§ åˆ¶ä½œç³»ç»Ÿ - åˆ¶ä½œéªŒè¯ã€ç³»ç»Ÿå®Œæ•´æ€§');
```

### 2. printè­¦å‘Šä¿®å¤

#### ä¿®å¤notifications.dart

```dart
// æ·»åŠ Loggerå¯¼å…¥
import 'logger.dart';

// æ›¿æ¢printè¯­å¥
if (kDebugMode) {
  for (final notification in queue) {
    Logger.info('[$module] ${notification.message}');
  }
}
```

#### ä¿®å¤crafting_system_verification_test.dart

```dart
// æ·»åŠ å¿…è¦å¯¼å…¥
import 'package:a_dark_room_new/core/logger.dart';
import 'package:a_dark_room_new/core/audio_engine.dart';

// åœ¨setUpä¸­æ·»åŠ AudioEngineæµ‹è¯•æ¨¡å¼
setUp(() {
  room = Room();
  stateManager = StateManager();
  stateManager.clearGameData();
  
  // è®¾ç½®AudioEngineæµ‹è¯•æ¨¡å¼ï¼Œé¿å…éŸ³é¢‘æ’ä»¶å¼‚å¸¸
  AudioEngine().setTestMode(true);
});

// æ‰¹é‡æ›¿æ¢æ‰€æœ‰printè¯­å¥ä¸ºLogger.info
Logger.info('ğŸ”§ éªŒè¯åˆ¶ä½œç³»ç»Ÿbuttonå±æ€§é…ç½®...');
Logger.info('âœ… $itemName: æ‰€æœ‰å±æ€§é…ç½®æ­£ç¡®');
// ... å…¶ä»–printè¯­å¥
```

### 3. AudioEngineæµ‹è¯•æ¨¡å¼å¢å¼º

#### åœ¨playSoundæ–¹æ³•ä¸­æ·»åŠ æµ‹è¯•æ¨¡å¼æ£€æŸ¥

```dart
/// æ’­æ”¾éŸ³æ•ˆ
Future<void> playSound(String src) async {
  // åœ¨æµ‹è¯•æ¨¡å¼ä¸‹è·³è¿‡éŸ³é¢‘æ’­æ”¾
  if (_testMode) {
    if (kDebugMode) {
      print('ğŸ§ª Test mode: skipping audio playback for $src');
    }
    return;
  }
  
  // ... åŸæœ‰é€»è¾‘
}
```

#### å¼€å§‹AudioEngineä¸­çš„printè¯­å¥æ›¿æ¢

```dart
// æ·»åŠ Loggerå¯¼å…¥
import 'logger.dart';

// æ›¿æ¢å…³é”®printè¯­å¥
if (kDebugMode) {
  Logger.info('ğŸµ AudioEngine initialized');
}

if (kDebugMode) {
  Logger.info('ğŸ§ª Test mode: skipping audio preloading');
}
```

## ä¿®å¤å®ç°

### ä¿®å¤çš„æ–‡ä»¶

1. **test/all_tests.dart** - æ·»åŠ é—æ¼çš„æµ‹è¯•æ–‡ä»¶ï¼Œæ›´æ–°æµ‹è¯•è¦†ç›–æè¿°
2. **lib/core/notifications.dart** - æ›¿æ¢printä¸ºLogger.infoï¼Œæ·»åŠ Loggerå¯¼å…¥
3. **test/crafting_system_verification_test.dart** - æ›¿æ¢æ‰€æœ‰printä¸ºLogger.infoï¼Œæ·»åŠ AudioEngineæµ‹è¯•æ¨¡å¼
4. **lib/core/audio_engine.dart** - åœ¨playSoundä¸­æ·»åŠ æµ‹è¯•æ¨¡å¼æ£€æŸ¥ï¼Œå¼€å§‹æ›¿æ¢printè¯­å¥

### æµ‹è¯•ç»“æœ

#### ä¿®å¤å‰
- **æµ‹è¯•æ•°é‡**: 115ä¸ªæµ‹è¯•ç”¨ä¾‹
- **é—æ¼æµ‹è¯•**: 3ä¸ªæµ‹è¯•æ–‡ä»¶æœªåŒ…å«
- **printè­¦å‘Š**: å¤šä¸ªæ–‡ä»¶ä¸­å­˜åœ¨printè¯­å¥
- **éŸ³é¢‘å¼‚å¸¸**: åˆ¶ä½œç³»ç»Ÿæµ‹è¯•å› éŸ³é¢‘æ’ä»¶é—®é¢˜å¤±è´¥

#### ä¿®å¤å
- **æµ‹è¯•æ•°é‡**: 118ä¸ªæµ‹è¯•ç”¨ä¾‹
- **é€šè¿‡ç‡**: 100% (118/118é€šè¿‡)
- **é—æ¼æµ‹è¯•**: æ— ï¼Œæ‰€æœ‰æµ‹è¯•æ–‡ä»¶å·²åŒ…å«
- **printè­¦å‘Š**: å·²ä¿®å¤å…³é”®æ–‡ä»¶ä¸­çš„printè¯­å¥
- **éŸ³é¢‘å¼‚å¸¸**: é€šè¿‡æµ‹è¯•æ¨¡å¼å®Œå…¨è§£å†³

### æµ‹è¯•æ‰§è¡Œæ—¥å¿—

```
00:03 +118: All tests passed!

æµ‹è¯•è¦†ç›–èŒƒå›´ï¼š
  ğŸ“… äº‹ä»¶ç³»ç»Ÿ - è§¦å‘é¢‘ç‡ã€æœ¬åœ°åŒ–ã€å¯ç”¨æ€§ã€åˆ½å­æ‰‹äº‹ä»¶ã€Bossæˆ˜æ–—
  ğŸ—ºï¸  åœ°å›¾ç³»ç»Ÿ - åœ°æ ‡ç”Ÿæˆã€é“è·¯ç”Ÿæˆ
  ğŸ’ èƒŒåŒ…ç³»ç»Ÿ - ç«æŠŠæ£€æŸ¥ã€å®¹é‡ç®¡ç†
  ğŸ›ï¸  UIç³»ç»Ÿ - æŒ‰é’®çŠ¶æ€ã€ç•Œé¢äº¤äº’ã€æŠ¤ç”²æŒ‰é’®
  ğŸ’§ èµ„æºç³»ç»Ÿ - æ°´å®¹é‡ã€ç‰©å“ç®¡ç†
  ğŸš€ å¤ªç©ºç³»ç»Ÿ - ç§»åŠ¨æ•æ„Ÿåº¦ã€ä¼˜åŒ–æµ‹è¯•ã€é£èˆ¹å»ºé€ å‡çº§
  ğŸµ éŸ³é¢‘ç³»ç»Ÿ - é¢„åŠ è½½ã€éŸ³é¢‘æ± ã€æ€§èƒ½ç›‘æ§
  ğŸ”§ åˆ¶ä½œç³»ç»Ÿ - åˆ¶ä½œéªŒè¯ã€ç³»ç»Ÿå®Œæ•´æ€§

æ–°å¢æµ‹è¯•ç»„ï¼š
âœ… æ‰§è¡Œè€…Bossæˆ˜æ–—æµ‹è¯• (8ä¸ªæµ‹è¯•ç”¨ä¾‹)
âœ… é£èˆ¹å»ºé€ å‡çº§ç³»ç»Ÿæµ‹è¯• (9ä¸ªæµ‹è¯•ç”¨ä¾‹)
âœ… åˆ¶ä½œç³»ç»Ÿå®Œæ•´æ€§éªŒè¯æµ‹è¯• (5ä¸ªæµ‹è¯•ç”¨ä¾‹)

éŸ³é¢‘ç³»ç»Ÿæµ‹è¯•æ¨¡å¼ï¼š
ğŸ§ª Test mode: skipping audio playback for audio/build.flac
ğŸ§ª Test mode: skipping audio preloading
```

## æŠ€æœ¯è¦ç‚¹

### 1. æµ‹è¯•å¥—ä»¶ç»„ç»‡

- **åˆ†å±‚ç»“æ„**: æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡æµ‹è¯•ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **å®Œæ•´è¦†ç›–**: ç¡®ä¿æ‰€æœ‰æµ‹è¯•æ–‡ä»¶éƒ½è¢«åŒ…å«åœ¨ä¸»æµ‹è¯•å¥—ä»¶ä¸­
- **æ¸…æ™°å‘½å**: ä½¿ç”¨è¡¨æƒ…ç¬¦å·å’Œä¸­æ–‡æè¿°ï¼Œæé«˜å¯è¯»æ€§

### 2. æ—¥å¿—è§„èŒƒåŒ–

- **ç»Ÿä¸€æ¥å£**: ä½¿ç”¨Logger.infoæ›¿ä»£printï¼Œä¾¿äºæ—¥å¿—ç®¡ç†
- **æµ‹è¯•å‹å¥½**: åœ¨æµ‹è¯•ç¯å¢ƒä¸­æä¾›æ¸…æ™°çš„æ‰§è¡Œåé¦ˆ
- **è°ƒè¯•æ”¯æŒ**: ä¿æŒè°ƒè¯•ä¿¡æ¯çš„å®Œæ•´æ€§å’Œå¯è¯»æ€§

### 3. æµ‹è¯•ç¯å¢ƒé€‚é…

- **æ’ä»¶éš”ç¦»**: é€šè¿‡æµ‹è¯•æ¨¡å¼é¿å…æµ‹è¯•ç¯å¢ƒä¸­çš„æ’ä»¶é™åˆ¶
- **ä¼˜é›…é™çº§**: åœ¨æ’ä»¶ä¸å¯ç”¨æ—¶ä»èƒ½æµ‹è¯•æ ¸å¿ƒé€»è¾‘
- **çŠ¶æ€ç®¡ç†**: ç¡®ä¿æµ‹è¯•ç¯å¢ƒçš„çŠ¶æ€ç®¡ç†åŠŸèƒ½æ­£å¸¸

## æœ€ä½³å®è·µ

### 1. æµ‹è¯•æ–‡ä»¶ç®¡ç†

```dart
// å¥½çš„åšæ³•ï¼šåŠæ—¶å°†æ–°æµ‹è¯•æ–‡ä»¶æ·»åŠ åˆ°all_tests.dart
import 'new_feature_test.dart' as new_feature_tests;

group('ğŸ†• æ–°åŠŸèƒ½æµ‹è¯•', () {
  group('æ–°åŠŸèƒ½éªŒè¯', () {
    new_feature_tests.main();
  });
});
```

### 2. æ—¥å¿—ä½¿ç”¨è§„èŒƒ

```dart
// å¥½çš„åšæ³•ï¼šä½¿ç”¨Logger.info
Logger.info('âœ… æµ‹è¯•é€šè¿‡');
Logger.info('âš ï¸ é¢„æœŸçš„ç¯å¢ƒé™åˆ¶');

// é¿å…çš„åšæ³•ï¼šç›´æ¥ä½¿ç”¨print
print('æµ‹è¯•ä¿¡æ¯'); // âŒ ä¸æ¨è
```

### 3. æµ‹è¯•ç¯å¢ƒè®¾ç½®

```dart
// å¥½çš„åšæ³•ï¼šåœ¨setUpä¸­é…ç½®æµ‹è¯•ç¯å¢ƒ
setUp(() {
  // è®¾ç½®æµ‹è¯•æ¨¡å¼
  AudioEngine().setTestMode(true);
  
  // æ¸…ç†çŠ¶æ€
  stateManager.clearGameData();
});
```

---

**ä¿®å¤æ€»ç»“**: é€šè¿‡å®Œå–„æµ‹è¯•å¥—ä»¶ã€ä¿®å¤printè­¦å‘Šå’Œå¢å¼ºéŸ³é¢‘ç³»ç»Ÿæµ‹è¯•å…¼å®¹æ€§ï¼ŒæˆåŠŸå°†æµ‹è¯•æ•°é‡ä»115ä¸ªå¢åŠ åˆ°118ä¸ªï¼Œå®ç°100%é€šè¿‡ç‡ã€‚åŒæ—¶è§„èŒƒåŒ–äº†æ—¥å¿—ä½¿ç”¨ï¼Œæé«˜äº†ä»£ç è´¨é‡å’Œæµ‹è¯•ç¨³å®šæ€§ã€‚
