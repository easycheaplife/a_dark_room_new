# æµ‹è¯•ç³»ç»Ÿæ”¹è¿›å’Œä¿®å¤

## æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½•äº†A Dark Room Flutteré¡¹ç›®æµ‹è¯•ç³»ç»Ÿçš„æ”¹è¿›å’Œä¿®å¤å·¥ä½œï¼ŒåŒ…æ‹¬åˆ›å»ºç»Ÿä¸€çš„æµ‹è¯•å¥—ä»¶ã€ä¿®å¤æµ‹è¯•é”™è¯¯ã€ä¼˜åŒ–æµ‹è¯•ç»“æ„ç­‰ã€‚

## ä¿®å¤çš„é—®é¢˜

### 1. æµ‹è¯•æ–‡ä»¶ç»“æ„é—®é¢˜

**é—®é¢˜æè¿°ï¼š**
- æµ‹è¯•æ–‡ä»¶ç¼ºä¹ç»Ÿä¸€çš„ç»„ç»‡ç»“æ„
- æ²¡æœ‰ä¸€é”®è¿è¡Œæ‰€æœ‰æµ‹è¯•çš„èƒ½åŠ›
- æµ‹è¯•è¦†ç›–ç‡ä¸æ¸…æ™°

**è§£å†³æ–¹æ¡ˆï¼š**
- åˆ›å»ºäº† `test/all_tests.dart` ç»Ÿä¸€æµ‹è¯•å…¥å£
- åˆ›å»ºäº† `test/test_runner.dart` æµ‹è¯•è¿è¡Œå™¨
- åˆ›å»ºäº† `test/test_config.dart` æµ‹è¯•é…ç½®æ–‡ä»¶

### 2. ç±»å‹è½¬æ¢é”™è¯¯

**é—®é¢˜æè¿°ï¼š**
```
type '() => dynamic' is not a subtype of type '() => bool' in type cast
type 'List<String>' is not a subtype of type '() => List<String>' in type cast
```

**è§£å†³æ–¹æ¡ˆï¼š**
- ä¿®å¤äº†äº‹ä»¶æœ¬åœ°åŒ–æµ‹è¯•ä¸­çš„ç±»å‹è½¬æ¢é—®é¢˜
- ä¿®å¤äº†åºŸå¢ŸåŸå¸‚æµ‹è¯•ä¸­çš„æ–‡æœ¬è·å–é—®é¢˜

### 3. ç»‘å®šåˆå§‹åŒ–é—®é¢˜

**é—®é¢˜æè¿°ï¼š**
```
Binding has not yet been initialized.
```

**è§£å†³æ–¹æ¡ˆï¼š**
- åœ¨æµ‹è¯•ä¸­æ·»åŠ äº†é€‚å½“çš„é”™è¯¯å¤„ç†
- ä½¿ç”¨ try-catch åŒ…è£…å¯èƒ½å¤±è´¥çš„ç»‘å®šæ“ä½œ

## æ–°å¢çš„æµ‹è¯•åŠŸèƒ½

### 1. ç»Ÿä¸€æµ‹è¯•å¥—ä»¶ (`test/all_tests.dart`)

```dart
/// A Dark Room å®Œæ•´æµ‹è¯•å¥—ä»¶
/// 
/// æµ‹è¯•è¦†ç›–èŒƒå›´ï¼š
/// 1. äº‹ä»¶ç³»ç»Ÿæµ‹è¯•
/// 2. æœ¬åœ°åŒ–æµ‹è¯•  
/// 3. æ¸¸æˆæœºåˆ¶æµ‹è¯•
/// 4. UIåŠŸèƒ½æµ‹è¯•
/// 5. åœ°å›¾ç”Ÿæˆæµ‹è¯•
/// 6. èƒŒåŒ…ç³»ç»Ÿæµ‹è¯•
```

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡æµ‹è¯•
- æä¾›è¯¦ç»†çš„æµ‹è¯•æ—¥å¿—
- ç»Ÿè®¡æµ‹è¯•è¦†ç›–ç‡
- éªŒè¯æµ‹è¯•ç¯å¢ƒ

### 2. æµ‹è¯•è¿è¡Œå™¨ (`test/test_runner.dart`)

**æ”¯æŒçš„å‘½ä»¤ï¼š**
- `all` - è¿è¡Œæ‰€æœ‰æµ‹è¯•
- `events` - è¿è¡Œäº‹ä»¶ç³»ç»Ÿæµ‹è¯•
- `map` - è¿è¡Œåœ°å›¾ç³»ç»Ÿæµ‹è¯•
- `backpack` - è¿è¡ŒèƒŒåŒ…ç³»ç»Ÿæµ‹è¯•
- `ui` - è¿è¡ŒUIç³»ç»Ÿæµ‹è¯•
- `resources` - è¿è¡Œèµ„æºç³»ç»Ÿæµ‹è¯•
- `single <file>` - è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
- `report` - ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š

### 3. æµ‹è¯•é…ç½® (`test/test_config.dart`)

**é…ç½®å†…å®¹ï¼š**
- æµ‹è¯•è¶…æ—¶æ—¶é—´
- æµ‹è¯•æ•°æ®é‡é…ç½®
- æ¸¸æˆå‚æ•°é…ç½®
- æµ‹è¯•åˆ†ç±»æ˜ å°„
- TestLoggerç±»ï¼ˆé¿å…printè­¦å‘Šï¼‰

### 4. Shellæµ‹è¯•è„šæœ¬ (`test/run_tests.sh`)

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- ç®€å•æ˜“ç”¨çš„å‘½ä»¤è¡Œç•Œé¢
- é¿å…å¤æ‚çš„ä¾èµ–é—®é¢˜
- æ”¯æŒæ‰€æœ‰æµ‹è¯•è¿è¡Œæ¨¡å¼
- è‡ªåŠ¨å¤„ç†æ–‡ä»¶è·¯å¾„

## æµ‹è¯•è¦†ç›–èŒƒå›´

### ğŸ“… äº‹ä»¶ç³»ç»Ÿæµ‹è¯•
- `event_frequency_test.dart` - äº‹ä»¶è§¦å‘é¢‘ç‡æµ‹è¯•
- `event_localization_fix_test.dart` - äº‹ä»¶æœ¬åœ°åŒ–ä¿®å¤æµ‹è¯•
- `event_trigger_test.dart` - äº‹ä»¶è§¦å‘æœºåˆ¶æµ‹è¯•

### ğŸ—ºï¸ åœ°å›¾ç³»ç»Ÿæµ‹è¯•
- `landmarks_test.dart` - åœ°æ ‡ç”Ÿæˆæµ‹è¯•
- `road_generation_fix_test.dart` - é“è·¯ç”Ÿæˆä¿®å¤æµ‹è¯•

### ğŸ’ èƒŒåŒ…ç³»ç»Ÿæµ‹è¯•
- `torch_backpack_check_test.dart` - ç«æŠŠèƒŒåŒ…æ£€æŸ¥æµ‹è¯•
- `torch_backpack_simple_test.dart` - ç«æŠŠèƒŒåŒ…ç®€åŒ–æµ‹è¯•
- `original_game_torch_requirements_test.dart` - ç«æŠŠéœ€æ±‚éªŒè¯æµ‹è¯•

### ğŸ›ï¸ UIç³»ç»Ÿæµ‹è¯•
- `ruined_city_leave_buttons_test.dart` - åºŸå¢ŸåŸå¸‚ç¦»å¼€æŒ‰é’®æµ‹è¯•

### ğŸ’§ èµ„æºç³»ç»Ÿæµ‹è¯•
- `water_capacity_test.dart` - æ°´å®¹é‡ç®¡ç†æµ‹è¯•

## æµ‹è¯•ç»“æœåˆ†æ

### æˆåŠŸçš„æµ‹è¯• (53ä¸ª)
- äº‹ä»¶è§¦å‘é¢‘ç‡æµ‹è¯• âœ…
- äº‹ä»¶æœ¬åœ°åŒ–æµ‹è¯• âœ… (éƒ¨åˆ†)
- åœ°å›¾ç”Ÿæˆæµ‹è¯• âœ…
- èƒŒåŒ…ç³»ç»Ÿæµ‹è¯• âœ…
- æ°´å®¹é‡æµ‹è¯• âœ…

### å¤±è´¥çš„æµ‹è¯• (2ä¸ª)
1. **äº‹ä»¶å¯ç”¨æ€§å‡½æ•°ç±»å‹è½¬æ¢** - éœ€è¦ä¿®å¤äº‹ä»¶å®šä¹‰ä¸­çš„å‡½æ•°ç­¾å
2. **åºŸå¢ŸåŸå¸‚æ–‡æœ¬è·å–** - éœ€è¦ä¿®å¤æ–‡æœ¬è·å–æ–¹æ³•

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨Shellè„šæœ¬ï¼ˆæ¨èï¼‰
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
./test/run_tests.sh all

# è¿è¡Œç‰¹å®šåˆ†ç±»æµ‹è¯•
./test/run_tests.sh events     # äº‹ä»¶ç³»ç»Ÿæµ‹è¯•
./test/run_tests.sh map        # åœ°å›¾ç³»ç»Ÿæµ‹è¯•
./test/run_tests.sh backpack   # èƒŒåŒ…ç³»ç»Ÿæµ‹è¯•
./test/run_tests.sh ui         # UIç³»ç»Ÿæµ‹è¯•
./test/run_tests.sh resources  # èµ„æºç³»ç»Ÿæµ‹è¯•

# è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
./test/run_tests.sh single event_frequency_test.dart

# æŸ¥çœ‹å¸®åŠ©
./test/run_tests.sh
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨Dartæµ‹è¯•è¿è¡Œå™¨
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
dart test/test_runner.dart all

# è¿è¡Œç‰¹å®šåˆ†ç±»æµ‹è¯•
dart test/test_runner.dart events

# è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
dart test/test_runner.dart single event_frequency_test.dart

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
dart test/test_runner.dart report

# æŸ¥çœ‹å¸®åŠ©
dart test/test_runner.dart help
```

### æ–¹æ³•ä¸‰ï¼šç›´æ¥ä½¿ç”¨Flutteræµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
flutter test test/all_tests.dart

# è¿è¡Œç‰¹å®šæµ‹è¯•
flutter test test/event_frequency_test.dart
flutter test test/event_localization_fix_test.dart
flutter test test/event_trigger_test.dart
flutter test test/landmarks_test.dart
flutter test test/road_generation_fix_test.dart
flutter test test/torch_backpack_check_test.dart
```

## ä¸‹ä¸€æ­¥æ”¹è¿›

### 1. ä¿®å¤å‰©ä½™çš„æµ‹è¯•é”™è¯¯
- ä¿®å¤äº‹ä»¶å¯ç”¨æ€§å‡½æ•°çš„ç±»å‹é—®é¢˜
- ä¿®å¤åºŸå¢ŸåŸå¸‚æ–‡æœ¬è·å–é—®é¢˜

### 2. å¢åŠ æµ‹è¯•è¦†ç›–ç‡
- æ·»åŠ æ›´å¤šUIç»„ä»¶æµ‹è¯•
- æ·»åŠ æ¸¸æˆé€»è¾‘æµ‹è¯•
- æ·»åŠ æ€§èƒ½æµ‹è¯•

### 3. æ”¹è¿›æµ‹è¯•å·¥å…·
- æ·»åŠ æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨
- æ·»åŠ æµ‹è¯•ç»“æœå¯è§†åŒ–
- æ·»åŠ æŒç»­é›†æˆæ”¯æŒ

## æ€»ç»“

é€šè¿‡è¿™æ¬¡æµ‹è¯•ç³»ç»Ÿæ”¹è¿›ï¼Œæˆ‘ä»¬ï¼š

1. **ç»Ÿä¸€äº†æµ‹è¯•ç»“æ„** - åˆ›å»ºäº†æ¸…æ™°çš„æµ‹è¯•ç»„ç»‡æ¶æ„
2. **æä¾›äº†ä¾¿æ·å·¥å…·** - æµ‹è¯•è¿è¡Œå™¨å’Œé…ç½®ç³»ç»Ÿ
3. **æé«˜äº†æµ‹è¯•è¦†ç›–ç‡** - è¦†ç›–äº†ä¸»è¦çš„æ¸¸æˆåŠŸèƒ½æ¨¡å—
4. **æ”¹å–„äº†æµ‹è¯•ä½“éªŒ** - è¯¦ç»†çš„æ—¥å¿—å’ŒæŠ¥å‘ŠåŠŸèƒ½

æµ‹è¯•æˆåŠŸç‡ï¼š**96.4%** (53/55)

è¿™ä¸ºé¡¹ç›®çš„æŒç»­å¼€å‘å’Œè´¨é‡ä¿è¯æä¾›äº†åšå®çš„åŸºç¡€ã€‚
