# 煤矿建筑解锁测试指南

## 测试目的
验证煤矿事件完成后，煤矿建筑和煤矿工人是否正确解锁。

## 前置条件
1. 游戏发展到可以探索世界（有指南针）
2. 有足够的补给（熏肉和水）
3. 有基本的武器和装备

## 测试步骤

### 1. 准备阶段
- 确保有至少10个熏肉
- 确保有水壶或水桶
- 装备武器（建议铁剑或更好的武器）

### 2. 前往煤矿
- 从村庄出发，向西南方向移动
- 寻找煤矿地标（地图上显示为 `C`）
- 通常距离村庄约10格距离

### 3. 完成煤矿事件
**重要：必须完成所有三场战斗**

1. **第一场战斗（a1场景）**
   - 点击"攻击"按钮
   - 对战man敌人（血量10）
   - 战斗胜利后，**点击"继续"按钮**（不要点击"离开"）

2. **第二场战斗（a2场景）**
   - 对战man敌人（血量10）
   - 战斗胜利后，**点击"继续"按钮**

3. **第三场战斗（a3场景）**
   - 对战chief敌人（血量20，更强）
   - 战斗胜利后，**点击"继续"按钮**

4. **完成场景（cleared场景）**
   - 看到煤矿清理完成的消息
   - 点击"离开"返回地图

### 4. 返回村庄验证

1. **返回村庄**
   - 从煤矿返回村庄（地图上的 `A`）

2. **检查村庄页签**
   - 切换到"村庄"页签
   - 查看建筑列表，应该看到"煤矿: 1"

3. **检查工人管理**
   - 在村庄页签中查看工人按钮
   - 应该看到"煤矿工"按钮
   - 初始工人数为0，可以分配村民

4. **分配工人测试**
   - 点击煤矿工的"+"按钮分配1个村民
   - 观察是否开始生产煤炭
   - 检查库存中是否出现煤炭

## 预期结果

### 成功标志
- ✅ 村庄建筑列表中显示"煤矿: 1"
- ✅ 工人管理中出现"煤矿工"按钮
- ✅ 可以分配村民到煤矿工作
- ✅ 煤矿工开始生产煤炭（消耗熏肉）
- ✅ 库存中出现煤炭资源

### 失败标志
- ❌ 村庄建筑列表中没有煤矿
- ❌ 工人管理中没有煤矿工按钮
- ❌ 无法分配村民到煤矿
- ❌ 没有煤炭生产

## 常见问题

### Q: 为什么没有看到煤矿建筑？
A: 可能的原因：
1. 没有完成所有三场战斗
2. 在战斗胜利后点击了"离开"而不是"继续"
3. 需要重新完成完整的煤矿事件

### Q: 煤矿工按钮是灰色的？
A: 这是正常的，因为：
1. 初始工人数为0
2. 需要有可用的村民才能分配
3. 确保村庄有足够的人口

### Q: 分配了工人但没有生产煤炭？
A: 检查：
1. 是否有足够的熏肉（煤矿工消耗熏肉）
2. 等待一段时间，生产有延迟
3. 查看日志是否有收入信息

## 调试信息

如果遇到问题，可以查看浏览器控制台的日志：
- `🏗️ clearCoalMine() 被调用` - 煤矿解锁函数被调用
- `🏗️ 煤矿建筑已添加` - 建筑成功添加
- `🏭 收集来自 coal miner 的收入` - 煤矿工正在工作

## 其他矿物测试

相同的测试流程适用于：
- **铁矿**（地图上的 `I`）
- **硫磺矿**（地图上的 `S`）

每个矿物都需要完成完整的战斗序列才能解锁对应的建筑和工人。
