# æ°´å®¹é‡æ˜¾ç¤ºä¸ä¸€è‡´é—®é¢˜ä¿®å¤

## ğŸ› é—®é¢˜æè¿°

**é—®é¢˜**: åœ°å›¾æ¢ç´¢æ—¶å‡ºå‘æ—¶èƒŒåŒ…çš„æ°´çš„æ•°é‡å’Œè¿›å…¥åœ°å›¾åæ°´çš„æ•°é‡ä¸ä¸€è‡´ï¼ŒèƒŒåŒ…åªæœ‰10ï¼Œè¿›å…¥åœ°å›¾30ï¼Œåè€…æ˜¯å¯¹çš„ã€‚

**å½±å“**: ç©å®¶åœ¨å‡†å¤‡å‡ºå‘æ—¶çœ‹åˆ°çš„æ°´é‡ä¿¡æ¯ä¸å‡†ç¡®ï¼Œå¯èƒ½å¯¼è‡´é”™è¯¯çš„å†³ç­–ã€‚

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 

åœ¨`lib/screens/path_screen.dart`æ–‡ä»¶ä¸­ï¼Œæ°´é‡æ˜¾ç¤ºè¢«ç¡¬ç¼–ç ä¸ºå›ºå®šå€¼10ï¼Œè€Œä¸æ˜¯ä»Worldæ¨¡å—è·å–å®é™…çš„æœ€å¤§æ°´é‡ã€‚

### ä»£ç ä½ç½®

**é—®é¢˜ä»£ç **:
```dart
// lib/screens/path_screen.dart:264-266
Widget _buildWaterRow(StateManager stateManager, Localization localization) {
  // è¿™é‡Œåº”è¯¥ä»Worldæ¨¡å—è·å–æœ€å¤§æ°´é‡ï¼Œæš‚æ—¶ä½¿ç”¨å›ºå®šå€¼
  final maxWater = 10;  // âŒ ç¡¬ç¼–ç å›ºå®šå€¼
```

**æ­£ç¡®é€»è¾‘**:
- èƒŒåŒ…ç•Œé¢åº”è¯¥æ˜¾ç¤ºç©å®¶å½“å‰å¯æºå¸¦çš„æœ€å¤§æ°´é‡
- æœ€å¤§æ°´é‡æ ¹æ®ç©å®¶æ‹¥æœ‰çš„æ°´å®¹å™¨å‡çº§ç‰©å“è®¡ç®—ï¼š
  - åŸºç¡€: 10æ°´
  - æ°´å£¶(waterskin): +10 = 20æ°´
  - æ°´æ¡¶(cask): +20 = 30æ°´  
  - æ°´ç½(water tank): +50 = 60æ°´
  - æµä½“å›æ”¶å™¨(fluid recycler): +100 = 110æ°´

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### 1. æ·»åŠ Worldæ¨¡å—å¯¼å…¥

```dart
// lib/screens/path_screen.dart:1-10
import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import 'dart:ui' as ui;
import '../modules/path.dart';
import '../modules/world.dart';  // âœ… æ·»åŠ Worldæ¨¡å—å¯¼å…¥
import '../core/state_manager.dart';
import '../core/localization.dart';
import '../widgets/game_button.dart';
import '../widgets/unified_stores_container.dart';
import '../core/logger.dart';
```

### 2. ä¿®å¤æ°´é‡æ˜¾ç¤ºé€»è¾‘

```dart
// lib/screens/path_screen.dart:264-266
Widget _buildWaterRow(StateManager stateManager, Localization localization) {
  // ä»Worldæ¨¡å—è·å–å®é™…çš„æœ€å¤§æ°´é‡
  final maxWater = World.instance.getMaxWater();  // âœ… ä½¿ç”¨æ­£ç¡®çš„æ°´é‡è®¡ç®—
  
  return Row(
    mainAxisAlignment: MainAxisAlignment.spaceBetween,
    children: [
      Text(
        localization.translate('resources.water'),
        style: const TextStyle(
          color: Colors.black,
          fontSize: 16,
          fontFamily: 'Times New Roman',
        ),
      ),
      Text(
        '$maxWater',  // âœ… æ˜¾ç¤ºæ­£ç¡®çš„æœ€å¤§æ°´é‡
        style: const TextStyle(
          color: Colors.black,
          fontSize: 16,
          fontFamily: 'Times New Roman',
        ),
      ),
    ],
  );
}
```

## âœ… ä¿®å¤ç»“æœ

### ä¿®å¤å‰
- èƒŒåŒ…ç•Œé¢å§‹ç»ˆæ˜¾ç¤ºæ°´é‡ä¸º10
- ä¸å®é™…æ¸¸æˆä¸­çš„æ°´å®¹é‡ä¸ç¬¦
- ç©å®¶æ— æ³•å‡†ç¡®äº†è§£è‡ªå·±çš„æ°´èµ„æºçŠ¶å†µ

### ä¿®å¤å
- èƒŒåŒ…ç•Œé¢æ­£ç¡®æ˜¾ç¤ºå½“å‰æœ€å¤§æ°´é‡
- æ ¹æ®ç©å®¶æ‹¥æœ‰çš„æ°´å®¹å™¨å‡çº§ç‰©å“åŠ¨æ€è®¡ç®—
- ä¸åœ°å›¾æ¢ç´¢ä¸­çš„æ°´é‡æ˜¾ç¤ºä¿æŒä¸€è‡´

## ğŸ§ª æµ‹è¯•éªŒè¯

### è‡ªåŠ¨åŒ–æµ‹è¯•
è¿è¡Œå•å…ƒæµ‹è¯•éªŒè¯æ°´å®¹é‡è®¡ç®—é€»è¾‘ï¼š
```bash
flutter test test/water_capacity_test.dart
```

### æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

#### 1. å¯åŠ¨æ¸¸æˆ
```bash
flutter run -d chrome
```

#### 2. æµ‹è¯•åŸºç¡€æ°´é‡ (10æ°´)
1. å¼€å§‹æ–°æ¸¸æˆ
2. è¿›å…¥"æ¼«æ¼«å°˜é€”"ç•Œé¢
3. æ£€æŸ¥æ°´é‡æ˜¾ç¤ºåº”è¯¥ä¸º **10**

#### 3. æµ‹è¯•æ°´å£¶å‡çº§ (20æ°´)
1. åœ¨å°é»‘å±‹åˆ¶ä½œæ°´å£¶ (éœ€è¦50çš®é©)
2. è¿›å…¥"æ¼«æ¼«å°˜é€”"ç•Œé¢
3. æ£€æŸ¥æ°´é‡æ˜¾ç¤ºåº”è¯¥ä¸º **20**

#### 4. æµ‹è¯•æ°´æ¡¶å‡çº§ (30æ°´)
1. åˆ¶ä½œæ°´æ¡¶ (éœ€è¦100çš®é© + 20é“)
2. è¿›å…¥"æ¼«æ¼«å°˜é€”"ç•Œé¢
3. æ£€æŸ¥æ°´é‡æ˜¾ç¤ºåº”è¯¥ä¸º **30**

#### 5. æµ‹è¯•æ°´ç½å‡çº§ (60æ°´)
1. åˆ¶ä½œæ°´ç½ (éœ€è¦100é“ + 50é’¢)
2. è¿›å…¥"æ¼«æ¼«å°˜é€”"ç•Œé¢
3. æ£€æŸ¥æ°´é‡æ˜¾ç¤ºåº”è¯¥ä¸º **60**

#### 6. æµ‹è¯•æµä½“å›æ”¶å™¨å‡çº§ (110æ°´)
1. åˆ¶ä½œæµä½“å›æ”¶å™¨ (éœ€è¦2å¤–æ˜Ÿåˆé‡‘)
2. è¿›å…¥"æ¼«æ¼«å°˜é€”"ç•Œé¢
3. æ£€æŸ¥æ°´é‡æ˜¾ç¤ºåº”è¯¥ä¸º **110**

#### 7. éªŒè¯åœ°å›¾æ¢ç´¢ä¸€è‡´æ€§
1. åœ¨ä»»ä½•æ°´å®¹å™¨çŠ¶æ€ä¸‹å‡ºå‘æ¢ç´¢
2. è¿›å…¥åœ°å›¾åæ£€æŸ¥èƒŒåŒ…ä¸­çš„æ°´é‡
3. åº”è¯¥ä¸å‡ºå‘å‰æ˜¾ç¤ºçš„æœ€å¤§æ°´é‡ä¸€è‡´

### å¿«é€ŸéªŒè¯æ–¹æ³•
ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ§åˆ¶å°ï¼š
```javascript
// æ£€æŸ¥å½“å‰æœ€å¤§æ°´é‡
console.log('æœ€å¤§æ°´é‡:', World.instance.getMaxWater());

// è®¾ç½®ä¸åŒçš„æ°´å®¹å™¨å¹¶æµ‹è¯•
StateManager().set('stores.waterskin', 1);
console.log('æ°´å£¶æ°´é‡:', World.instance.getMaxWater()); // åº”è¯¥æ˜¯20

StateManager().set('stores.cask', 1);
console.log('æ°´æ¡¶æ°´é‡:', World.instance.getMaxWater()); // åº”è¯¥æ˜¯30
```

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `lib/screens/path_screen.dart` - èƒŒåŒ…ç•Œé¢æ°´é‡æ˜¾ç¤º
- `lib/modules/world.dart` - æ°´é‡è®¡ç®—é€»è¾‘
- `lib/screens/world_screen.dart` - åœ°å›¾ç•Œé¢æ°´é‡æ˜¾ç¤º
- `docs/water_capacity_growth_mechanism.md` - æ°´å®¹é‡æœºåˆ¶æ–‡æ¡£

## ğŸ”— ç›¸å…³é—®é¢˜

- ç¡®ä¿æ‰€æœ‰UIç•Œé¢çš„æ°´é‡æ˜¾ç¤ºéƒ½ä½¿ç”¨ç»Ÿä¸€çš„è®¡ç®—é€»è¾‘
- æ£€æŸ¥å…¶ä»–èµ„æºæ˜¾ç¤ºæ˜¯å¦å­˜åœ¨ç±»ä¼¼çš„ç¡¬ç¼–ç é—®é¢˜

## ğŸ“… ä¿®å¤ä¿¡æ¯

- **ä¿®å¤æ—¥æœŸ**: 2025-06-23
- **ä¿®å¤äººå‘˜**: Augment Agent
- **é—®é¢˜ä¸¥é‡ç¨‹åº¦**: ä¸­ç­‰ (å½±å“ç”¨æˆ·ä½“éªŒä½†ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½)
- **ä¿®å¤ç±»å‹**: ç•Œé¢æ˜¾ç¤ºä¿®å¤
