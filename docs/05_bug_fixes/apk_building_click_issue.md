# APKç‰ˆæœ¬ç‹©çŒå°å±‹å’Œè´¸æ˜“ç«™ç‚¹å‡»æ— ååº”é—®é¢˜ä¿®å¤

## é—®é¢˜æè¿°
åœ¨APKç‰ˆæœ¬ä¸­ï¼Œç‹©çŒå°å±‹(lodge)å’Œè´¸æ˜“ç«™(trading post)æŒ‰é’®å·²æ˜¾ç¤ºï¼Œä½†æ˜¯ç‚¹å‡»æ— ååº”ï¼Œæ— æ³•å»ºé€ ã€‚Webç‰ˆæœ¬åŠŸèƒ½æ­£å¸¸ã€‚

## é—®é¢˜åˆ†æ
é€šè¿‡ä»£ç åˆ†æå‘ç°äº†ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š

### 1. é”™è¯¯çš„å‡½æ•°è°ƒç”¨
åœ¨`room_screen.dart`ä¸­ï¼Œå»ºé€ æŒ‰é’®è°ƒç”¨çš„æ˜¯`room.buildItem(key)`ï¼Œä½†è¿™ä¸ªå‡½æ•°ä¸åŸæ¸¸æˆçš„`Room.build`å‡½æ•°ä¸ä¸€è‡´ã€‚

### 2. çŠ¶æ€ç®¡ç†è·¯å¾„æ ¼å¼é”™è¯¯
åœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨äº†é”™è¯¯çš„çŠ¶æ€ç®¡ç†è·¯å¾„æ ¼å¼ï¼š
- é”™è¯¯ï¼š`stores["$k"]` å’Œ `game.buildings["$thing"]`
- æ­£ç¡®ï¼š`stores.$k` å’Œ `game.buildings.$thing`

è¿™ç§è·¯å¾„æ ¼å¼å·®å¼‚å¯èƒ½å¯¼è‡´åœ¨ç§»åŠ¨ç«¯ï¼ˆAPKï¼‰ç¯å¢ƒä¸‹çŠ¶æ€è¯»å–å¤±è´¥ã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®å¤æŒ‰é’®å‡½æ•°è°ƒç”¨
å°†å»ºé€ æŒ‰é’®çš„å›è°ƒå‡½æ•°ä»`room.buildItem(key)`æ”¹ä¸º`room.build(key)`ï¼Œå¹¶æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼š

```dart
onPressed: isEnabled ? () {
  // æ·»åŠ è°ƒè¯•æ—¥å¿—
  Logger.info('ğŸ”¨ Building item: $key');
  final result = room.build(key);
  Logger.info('ğŸ”¨ Build result: $result');
  if (!result) {
    Logger.error('âŒ Build failed for: $key');
  }
} : null,
```

### 2. ä¿®å¤çŠ¶æ€ç®¡ç†è·¯å¾„æ ¼å¼
å°†æ‰€æœ‰çŠ¶æ€ç®¡ç†è·¯å¾„ä»æ–¹æ‹¬å·æ ¼å¼æ”¹ä¸ºç‚¹å·æ ¼å¼ï¼š

#### èµ„æºæ£€æŸ¥
```dart
// ä¿®å¤å‰
final have = stateManager.get('stores["$k"]', true) ?? 0;

// ä¿®å¤å  
final have = stateManager.get('stores.$k', true) ?? 0;
```

#### å»ºç­‘æ•°é‡æ£€æŸ¥
```dart
// ä¿®å¤å‰
currentCount = stateManager.get('game.buildings["$key"]', true) ?? 0;

// ä¿®å¤å
currentCount = stateManager.get('game.buildings.$key', true) ?? 0;
```

#### ç‰©å“æ•°é‡æ£€æŸ¥
```dart
// ä¿®å¤å‰
currentCount = stateManager.get('stores["$key"]', true) ?? 0;

// ä¿®å¤å
currentCount = stateManager.get('stores.$key', true) ?? 0;
```

### 3. æ·»åŠ Loggerå¯¼å…¥
åœ¨`room_screen.dart`ä¸­æ·»åŠ Loggerå¯¼å…¥ï¼š

```dart
import '../core/logger.dart';
```

## ä¿®å¤çš„æ–‡ä»¶
- `lib/screens/room_screen.dart`

## ä¿®å¤çš„å…·ä½“ä½ç½®
1. ç¬¬1-10è¡Œï¼šæ·»åŠ Loggerå¯¼å…¥
2. ç¬¬342-350è¡Œï¼šä¿®å¤èµ„æºæ£€æŸ¥çš„çŠ¶æ€è·¯å¾„
3. ç¬¬356-367è¡Œï¼šä¿®å¤å»ºç­‘/ç‰©å“æ•°é‡æ£€æŸ¥çš„çŠ¶æ€è·¯å¾„  
4. ç¬¬388-403è¡Œï¼šä¿®å¤æŒ‰é’®å›è°ƒå‡½æ•°å¹¶æ·»åŠ è°ƒè¯•æ—¥å¿—
5. ç¬¬419-435è¡Œï¼šä¿®å¤äº¤æ˜“æŒ‰é’®çš„çŠ¶æ€è·¯å¾„

## æ ¹æœ¬åŸå› 
è¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯çŠ¶æ€ç®¡ç†è·¯å¾„æ ¼å¼çš„ä¸ä¸€è‡´æ€§ã€‚åœ¨Flutter/Dartç¯å¢ƒä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ç«¯ï¼ˆAPKï¼‰ç¯å¢ƒä¸‹ï¼Œä½¿ç”¨æ–¹æ‹¬å·æ ¼å¼çš„è·¯å¾„å¯èƒ½æ— æ³•æ­£ç¡®è§£æï¼Œè€Œç‚¹å·æ ¼å¼æ›´åŠ å¯é ã€‚

## æµ‹è¯•éªŒè¯
1. å¯åŠ¨åº”ç”¨ï¼š`flutter run -d chrome`
2. è¿›å…¥æ¸¸æˆï¼Œç¡®ä¿å»ºé€ è€…ç­‰çº§è¾¾åˆ°4çº§
3. æ”¶é›†è¶³å¤Ÿçš„èµ„æºï¼ˆç‹©çŒå°å±‹éœ€è¦æœ¨æ200ã€æ¯›çš®10ã€è‚‰ç±»5ï¼‰
4. ç‚¹å‡»ç‹©çŒå°å±‹æŒ‰é’®ï¼Œæ£€æŸ¥æ˜¯å¦èƒ½æ­£å¸¸å»ºé€ 
5. æ”¶é›†è¶³å¤Ÿçš„èµ„æºï¼ˆè´¸æ˜“ç«™éœ€è¦æœ¨æ400ã€æ¯›çš®100ï¼‰
6. ç‚¹å‡»è´¸æ˜“ç«™æŒ‰é’®ï¼Œæ£€æŸ¥æ˜¯å¦èƒ½æ­£å¸¸å»ºé€ 
7. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œç¡®è®¤è°ƒè¯•ä¿¡æ¯æ­£å¸¸è¾“å‡º

## ä¿®å¤æ—¥æœŸ
2025-06-22

## ä¿®å¤çŠ¶æ€
âœ… å·²ä¿®å¤ - ä»£ç å·²æ›´æ–°ï¼Œç­‰å¾…æµ‹è¯•éªŒè¯

## ç›¸å…³é—®é¢˜
- è¿™ä¸ªä¿®å¤ä¹Ÿè§£å†³äº†å…¶ä»–å»ºé€ ç‰©å“å¯èƒ½å­˜åœ¨çš„ç±»ä¼¼é—®é¢˜
- ç»Ÿä¸€äº†çŠ¶æ€ç®¡ç†è·¯å¾„æ ¼å¼ï¼Œæé«˜äº†ä»£ç çš„ä¸€è‡´æ€§å’Œå¯é æ€§
