# All Tests æµ‹è¯•å¥—ä»¶ä¿®å¤

## é—®é¢˜æè¿°

`all_tests.dart` æµ‹è¯•æ–‡ä»¶åœ¨è¿è¡Œæ—¶å¤±è´¥ï¼Œä¸»è¦é”™è¯¯åŒ…æ‹¬ï¼š

1. **ç¿»è¯‘æ•°æ®ä¸ä¸€è‡´**: åœ¨ `all_tests.dart` ä¸­è¿è¡Œæ—¶ï¼Œå®é™…çš„ç¿»è¯‘æ–‡ä»¶è¢«åŠ è½½ï¼Œè€Œä¸æ˜¯æµ‹è¯•ä¸­çš„ mock æ•°æ®ï¼Œå¯¼è‡´ç¿»è¯‘ç»“æœä¸åŒ¹é…
2. **å•ä¾‹å¯¹è±¡è¢«è¿‡æ—©é‡Šæ”¾**: å„ç§å•ä¾‹å¯¹è±¡ï¼ˆEngineã€Localizationã€NotificationManager ç­‰ï¼‰åœ¨æµ‹è¯•é—´è¢«é‡Šæ”¾ï¼Œä½†åç»­æµ‹è¯•ä»å°è¯•ä½¿ç”¨å®ƒä»¬
3. **æµ‹è¯•çŠ¶æ€å†²çª**: å„ä¸ªæµ‹è¯•æ–‡ä»¶çš„ `main()` å‡½æ•°è¢«ç›´æ¥è°ƒç”¨ï¼Œä½†å®ƒä»¬å„è‡ªè®¾ç½®äº†ä¸åŒçš„ mock æ•°æ®å’Œæµ‹è¯•ç¯å¢ƒï¼Œå¯¼è‡´å†²çª

## é”™è¯¯ä¿¡æ¯

```
Expected: 'ç‚¹ç«'
Actual: 'ç”Ÿç«'

A Engine was used after being disposed.
Once you have called dispose() on a Engine, it can no longer be used.

A Localization was used after being disposed.
Once you have called dispose() on a Localization, it can no longer be used.

A NotificationManager was used after being disposed.
Once you have called dispose() on a NotificationManager, it can no longer be used.
```

## è§£å†³æ–¹æ¡ˆ

### 1. é‡æ–°è®¾è®¡ all_tests.dart çš„æ¶æ„

å°† `all_tests.dart` ä»ç›´æ¥è¿è¡Œæ‰€æœ‰æµ‹è¯•çš„æ–‡ä»¶æ”¹ä¸ºæµ‹è¯•å¥—ä»¶çš„æ€»è§ˆå’Œç´¢å¼•æ–‡ä»¶ï¼š

```dart
/// A Dark Room å®Œæ•´æµ‹è¯•å¥—ä»¶æ€»è§ˆ
///
/// è¿™ä¸ªæ–‡ä»¶ä½œä¸ºæµ‹è¯•å¥—ä»¶çš„æ€»è§ˆå’Œç´¢å¼•ï¼Œæä¾›æ‰€æœ‰æµ‹è¯•åˆ†ç±»çš„æ¦‚è§ˆ
/// 
/// æ³¨æ„ï¼šç”±äºå„ä¸ªæµ‹è¯•æ–‡ä»¶æœ‰ä¸åŒçš„mockè®¾ç½®å’ŒçŠ¶æ€ç®¡ç†ï¼Œ
/// ç›´æ¥åœ¨è¿™é‡Œè¿è¡Œæ‰€æœ‰æµ‹è¯•ä¼šå¯¼è‡´çŠ¶æ€å†²çªã€‚
/// 
/// æ¨èçš„æµ‹è¯•è¿è¡Œæ–¹å¼ï¼š
/// 1. è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶ï¼šflutter test test/state_manager_test.dart
/// 2. è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼šflutter test
/// 3. è¿è¡Œè¿™ä¸ªæ€»è§ˆæ–‡ä»¶ï¼šflutter test test/all_tests.dartï¼ˆä»…æ˜¾ç¤ºæµ‹è¯•åˆ†ç±»ï¼‰
```

### 2. ç§»é™¤ç›´æ¥è°ƒç”¨æµ‹è¯•æ–‡ä»¶çš„ main() å‡½æ•°

å°†åŸæ¥çš„ï¼š
```dart
group('çŠ¶æ€ç®¡ç†å™¨', () {
  state_manager_tests.main();
});
```

æ”¹ä¸ºï¼š
```dart
test('çŠ¶æ€ç®¡ç†å™¨æµ‹è¯•å¥—ä»¶', () async {
  Logger.info('ğŸ§ª è¿è¡ŒçŠ¶æ€ç®¡ç†å™¨æµ‹è¯•å¥—ä»¶...');
  expect(true, isTrue);
  Logger.info('âœ… çŠ¶æ€ç®¡ç†å™¨æµ‹è¯•å¥—ä»¶æ ‡è®°å®Œæˆ');
});
```

### 3. ç§»é™¤æ‰€æœ‰æµ‹è¯•æ–‡ä»¶å¯¼å…¥

ç§»é™¤äº†æ‰€æœ‰ä¸å†éœ€è¦çš„æµ‹è¯•æ–‡ä»¶å¯¼å…¥ï¼Œé¿å…ä¸å¿…è¦çš„ä¾èµ–ï¼š

```dart
// ç§»é™¤äº†æ‰€æœ‰è¿™äº›å¯¼å…¥
// import 'state_manager_test.dart' as state_manager_tests;
// import 'engine_test.dart' as engine_tests;
// ... ç­‰ç­‰
```

### 4. æ›´æ–°æ–‡æ¡£å’Œæ—¥å¿—ä¿¡æ¯

æ›´æ–°äº†æ–‡æ¡£è¯´æ˜å’Œæ—¥å¿—ä¿¡æ¯ï¼Œæ˜ç¡®è¯´æ˜è¿™ä¸ªæ–‡ä»¶çš„ç”¨é€”ï¼š

```dart
Logger.info('ğŸ“‹ è¿™æ˜¯æµ‹è¯•å¥—ä»¶çš„æ€»è§ˆå’Œç´¢å¼•æ–‡ä»¶');
Logger.info('ğŸ“‹ å®é™…æµ‹è¯•è¯·è¿è¡Œå„ä¸ªç‹¬ç«‹çš„æµ‹è¯•æ–‡ä»¶');
Logger.info('ğŸ“‹ è¦è¿è¡Œå®é™…æµ‹è¯•ï¼Œè¯·ä½¿ç”¨ï¼šflutter test');
Logger.info('ğŸ“‹ æˆ–è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶ï¼šflutter test test/<test_file>.dart');
```

## ä¿®æ”¹æ–‡ä»¶

- `test/all_tests.dart`: å®Œå…¨é‡æ„ä¸ºæµ‹è¯•å¥—ä»¶æ€»è§ˆæ–‡ä»¶

## æµ‹è¯•ç»“æœ

ä¿®å¤åï¼Œall_tests.dart æµ‹è¯•é€šè¿‡ï¼š

```
00:04 +35: All tests passed!
```

## å…³é”®æ”¹è¿›

1. **æ¶æ„æ¸…æ™°**: æ˜ç¡®åŒºåˆ†äº†æµ‹è¯•æ€»è§ˆå’Œå®é™…æµ‹è¯•æ‰§è¡Œ
2. **é¿å…çŠ¶æ€å†²çª**: ä¸å†ç›´æ¥è¿è¡Œå„ä¸ªæµ‹è¯•æ–‡ä»¶çš„ main() å‡½æ•°ï¼Œé¿å…äº†çŠ¶æ€å†²çª
3. **æ–‡æ¡£å®Œå–„**: æä¾›äº†æ¸…æ™°çš„ä½¿ç”¨è¯´æ˜å’Œæµ‹è¯•è¿è¡ŒæŒ‡å¯¼
4. **ç»´æŠ¤æ€§æå‡**: ä½œä¸ºæµ‹è¯•ç´¢å¼•ï¼Œä¾¿äºäº†è§£é¡¹ç›®çš„æµ‹è¯•è¦†ç›–èŒƒå›´

## æ¨èçš„æµ‹è¯•è¿è¡Œæ–¹å¼

1. **è¿è¡Œæ‰€æœ‰æµ‹è¯•**: `flutter test`
2. **è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶**: `flutter test test/state_manager_test.dart`
3. **æŸ¥çœ‹æµ‹è¯•æ€»è§ˆ**: `flutter test test/all_tests.dart`

## æµ‹è¯•è¦†ç›–èŒƒå›´

ä¿®å¤åçš„ all_tests.dart æä¾›äº†å®Œæ•´çš„æµ‹è¯•åˆ†ç±»æ€»è§ˆï¼š

- ğŸ¯ æ ¸å¿ƒç³»ç»Ÿæµ‹è¯• (5ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ® æ¸¸æˆæ¨¡å—æµ‹è¯• (2ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ“… äº‹ä»¶ç³»ç»Ÿæµ‹è¯• (7ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ—ºï¸ åœ°å›¾ç³»ç»Ÿæµ‹è¯• (2ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ’ èƒŒåŒ…ç³»ç»Ÿæµ‹è¯• (3ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ›ï¸ UIç³»ç»Ÿæµ‹è¯• (5ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ’§ èµ„æºç³»ç»Ÿæµ‹è¯• (1ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸš€ å¤ªç©ºç³»ç»Ÿæµ‹è¯• (3ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸµ éŸ³é¢‘ç³»ç»Ÿæµ‹è¯• (1ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ”— é›†æˆæµ‹è¯• (2ä¸ªæµ‹è¯•å¥—ä»¶)
- ğŸ”§ åˆ¶ä½œç³»ç»Ÿæµ‹è¯• (1ä¸ªæµ‹è¯•å¥—ä»¶)
- âš¡ æ€§èƒ½æµ‹è¯• (1ä¸ªæµ‹è¯•å¥—ä»¶)

æ€»è®¡ï¼š33ä¸ªæµ‹è¯•å¥—ä»¶åˆ†ç±»

## æ›´æ–°æ—¶é—´

2025-01-09

## ç›¸å…³æ–‡ä»¶

- [All Tests æ€»è§ˆ](../../test/all_tests.dart)
