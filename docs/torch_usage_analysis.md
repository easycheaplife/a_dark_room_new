# A Dark Room 火把使用分析

**最后更新**: 2025-06-25

## 概述

本文档详细分析A Dark Room游戏中火把(torch)的作用、获取方式以及需要火把的地形和事件。火把是游戏中重要的探索工具，是进入某些危险地标的必需品。

## 🔥 火把的基本信息

### 制作配方
```dart
'torch': {
  'name': 'torch',
  'type': 'tool',
  'cost': {'wood': 1, 'cloth': 1},
  'buildMsg': 'craftables.torch.buildMsg'
}
```

- **制作材料**: 1个木材 + 1个布料
- **制作地点**: 房间(Room)模块的制作系统
- **物品类型**: 工具(tool)
- **可携带**: ✅ 可以在背包中携带

### 获取方式

#### 1. 制作获得
- **主要方式**: 在房间中使用木材和布料制作
- **前置条件**: 需要有火焰和建造者

#### 2. 探索获得
- **洞穴探索**: 在洞穴的某些场景中可以找到火把
- **概率**: 50%概率获得1-5个火把

```dart
// 洞穴场景a3中的火把奖励
'loot': {
  'cured meat': {'min': 1, 'max': 5, 'chance': 1.0},
  'torch': {'min': 1, 'max': 5, 'chance': 0.5},  // 50%概率
  'leather': {'min': 1, 'max': 5, 'chance': 0.3}
}
```

## 🗺️ 需要火把的地形

### 1. 潮湿洞穴 (V)
- **地形符号**: `V`
- **火把需求**: 进入需要1个火把
- **消耗时机**: 选择"进入"按钮时消耗
- **特殊机制**: 
  - 洞穴内部可能需要额外火把继续探索
  - 某些深层场景需要第二个火把

```dart
// 洞穴入口
'enter': {
  'cost': {'torch': 1},
  'nextScene': {'0.3': 'a1', '0.6': 'a2', '1': 'a3'}
}

// 洞穴深层继续探索
'continue': {
  'cost': {'torch': 1},  // 需要第二个火把
  'nextScene': {'1': 'c1'}
}
```

### 2. 铁矿 (I)
- **地形符号**: `I`
- **火把需求**: 进入需要1个火把
- **距离**: 距离村庄5格
- **奖励**: 铁、鳞片、布料等
- **解锁**: 完成后解锁铁矿建筑

```dart
// 铁矿入口
'enter': {
  'cost': {'torch': 1},
  'nextScene': {'1': 'enter'}
}
```

### 3. 煤矿 (C)
- **地形符号**: `C`
- **火把需求**: 进入需要1个火把
- **距离**: 距离村庄10格
- **奖励**: 煤炭、鳞片、布料等
- **解锁**: 完成后解锁煤矿建筑

```dart
// 煤矿入口
'enter': {
  'cost': {'torch': 1},
  'nextScene': {'0.5': 'b1', '1': 'b2'}
}
```

### 4. 硫磺矿 (S)
- **地形符号**: `S`
- **火把需求**: 进入需要1个火把
- **距离**: 距离村庄20格
- **奖励**: 硫磺、鳞片、布料等
- **解锁**: 完成后解锁硫磺矿建筑

```dart
// 硫磺矿入口
'enter': {
  'cost': {'torch': 1},
  'nextScene': {'0.5': 'b5', '1': 'b6'}
}
```

### 5. 废弃小镇 (O)
- **地形符号**: `O`
- **火把需求**: 进入需要1个火把
- **奖励**: 布料、皮革、药物等
- **特殊**: 简单地标，访问后变灰

```dart
// 废弃小镇入口
'enter': {
  'cost': {'torch': 1},
  'nextScene': 'interior'
}
```

## 🎯 火把的作用机制

### 1. 照明功能
- **基本作用**: 为黑暗的地下空间提供照明
- **游戏逻辑**: 没有火把无法进入危险的地下区域
- **现实意义**: 模拟真实的洞穴探索需求

### 2. 安全保障
- **风险管理**: 火把代表了探索未知区域的准备
- **资源投入**: 需要消耗材料制作，体现探索成本
- **策略选择**: 玩家需要权衡是否值得消耗火把探索

### 3. 进度门槛
- **探索限制**: 限制玩家过早进入高级区域
- **资源管理**: 需要合理分配木材和布料
- **技能要求**: 需要掌握制作系统

## 📊 火把消耗统计

### 完整探索所需火把数量

| 地形类型 | 基础消耗 | 深度探索 | 总计 | 备注 |
|----------|----------|----------|------|------|
| 潮湿洞穴(V) | 1个 | 0-1个 | 1-2个 | 深层探索可选 |
| 铁矿(I) | 1个 | 0个 | 1个 | 单次进入 |
| 煤矿(C) | 1个 | 0个 | 1个 | 单次进入 |
| 硫磺矿(S) | 1个 | 0个 | 1个 | 单次进入 |
| 废弃小镇(O) | 1个 | 0个 | 1个 | 单次进入 |
| **总计** | **5个** | **0-1个** | **5-6个** | 完整探索 |

### 推荐准备数量
- **最少准备**: 5个火把（每个地标1个）
- **安全准备**: 8-10个火把（包含备用和深度探索）
- **制作成本**: 8-10个木材 + 8-10个布料

## 🔄 火把的循环经济

### 投入产出分析

#### 投入成本
- **制作1个火把**: 1木材 + 1布料
- **制作10个火把**: 10木材 + 10布料

#### 探索收益
- **洞穴探索**: 可能获得1-5个火把（50%概率）
- **矿物地标**: 解锁建筑，获得大量资源
- **长期收益**: 建筑产出远超火把制作成本

#### 经济效益
- **短期**: 消耗资源制作火把
- **中期**: 通过探索获得更多资源
- **长期**: 解锁的建筑提供持续产出

## 🎮 游戏策略建议

### 1. 火把制作时机
- **早期**: 有了稳定的木材和布料来源后开始制作
- **中期**: 准备探索前批量制作
- **后期**: 根据需要随时制作

### 2. 探索顺序建议
1. **潮湿洞穴(V)**: 最近且可重复，先探索获得经验
2. **铁矿(I)**: 距离适中，解锁重要建筑
3. **煤矿(C)**: 进一步扩展资源
4. **硫磺矿(S)**: 最远但奖励丰厚
5. **废弃小镇(O)**: 根据需要探索

### 3. 资源管理
- **保持库存**: 始终保持2-3个火把备用
- **批量制作**: 一次制作多个火把提高效率
- **优先级**: 火把制作优先级高于其他工具

## 🔍 技术实现细节

### 火把消耗机制
```dart
// 事件按钮中的火把消耗
'cost': {'torch': 1}

// 消耗逻辑在Events模块中处理
if (buttonConfig['cost'] != null) {
  final costs = buttonConfig['cost'] as Map<String, dynamic>;
  for (final entry in costs.entries) {
    final key = entry.key;
    final cost = entry.value as int;
    final current = sm.get('stores.$key', true) ?? 0;
    if (current < cost) {
      // 资源不足，无法执行
      return;
    }
  }
  // 扣除成本
  for (final entry in costs.entries) {
    final key = entry.key;
    final cost = entry.value as int;
    final current = sm.get('stores.$key', true) ?? 0;
    sm.set('stores.$key', current - cost);
  }
}
```

### 背包携带支持
火把作为工具类物品，可以在背包中携带，支持世界地图探索。

## 📝 总结

火把在A Dark Room中扮演着重要的探索工具角色：

1. **必需品**: 进入5个重要地标的必需品
2. **资源管理**: 体现了游戏的资源管理策略
3. **进度控制**: 作为探索进度的自然门槛
4. **风险回报**: 投入火把获得更大的探索收益

合理的火把管理是成功探索世界地图的关键因素之一。
